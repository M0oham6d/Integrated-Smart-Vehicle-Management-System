/***************************************************************************************************************
 * Control_Car_Using_Bluetooth.c
 * Author: A7la Team
 * Module: APPLICATION
 **************************************************************************************************************/

#include "../HAL/motor.h"
#include "../MCAL/uart.h"
#include "../Standard_Types/standard_types.h"
#include <stdlib.h>
#include <util/delay.h>

/*
 * Description:
 * Function to convert speed character to numerical value.
 */
uint8 motorSpeed(uint8 speed)
{
	switch(speed)
	{
	case '1':
		return 70;
		break;
	case '2':
		return 85;
		break;
	case '3':
		return 100;
		break;
	default:
		return 0; // Default case to handle unexpected input
	}
}

int main(void)
{
	uint8 receivedMSG;

	UART_ConfigType uart_configuration = {9600, UART_Parity_NONE, UART_STOP_1_BIT, MODE_EIGHT_BIT};
	UART_init(&uart_configuration);

	DcMotor_Init(motorSpeed(UART_receiveByte()));

	while(1)
	{
		receivedMSG = UART_receiveByte();

		switch(receivedMSG)
		{
		case 'F':
		Forward();
		break;
		case 'B':
			Backward();
			break;
		case 'S':
			Stop();
			break;
		case 'R':
			Right_Forward();
			break;
		case 'L':
			Left_Forward();
			break;
		case 'M':
			DcMotor_Init(motorSpeed(UART_receiveByte()));
			break;
		default:
			// Handle unexpected input
			break;
		}
	}

	return 0;
}
